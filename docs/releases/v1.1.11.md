# v1.1.11

**Release Date:** 2025-12-27

**Type:** Stable Release

## What's Changed

This release introduces significant improvements to the configuration system with automatic migration support.

### Config Entry Migration (v1 → v2)

- **Breaking Change**: Config entry version upgraded from 1 to 2
- **Automatic Migration**: `scan_interval` and `timeout` moved from `data` to `options`
- Existing installations are automatically migrated on first load
- Downgrade protection added for future config versions

### OptionsFlowWithReload

- Replaced manual update listener with Home Assistant's `OptionsFlowWithReload` pattern
- Options changes now automatically trigger integration reload
- Cleaner code without manual callback registration

### Config Flow Improvements

- Renamed internal method `get_unique_id()` → `_test_connection()` for clarity
- Added proper type hints throughout config flow
- Improved error handling in connection testing
- Fixed options flow initialization (removed incorrect constructor argument)

### Code Quality

- Added missing imports in `__init__.py`
- Removed commented-out legacy migration code
- Improved overall code structure

## Requirements

- Home Assistant 2025.10.0 or newer
- Python 3.13 or newer
- ModbusLink 1.3.2 or newer

## Upgrade Notes

- **Automatic**: No manual action required for existing installations
- **Migration**: Your `scan_interval` and `timeout` settings will be preserved
- **Verify**: After upgrade, check that options flow works (cogwheel icon)

## Full Changelog

[Compare v1.1.10...v1.1.11](https://github.com/alexdelprete/ha-sinapsi-alfa/compare/v1.1.10...v1.1.11)
