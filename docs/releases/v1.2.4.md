# Release v1.2.4

[![GitHub Downloads](https://img.shields.io/github/downloads/alexdelprete/ha-sinapsi-alfa/v1.2.4/total?style=for-the-badge)](https://github.com/alexdelprete/ha-sinapsi-alfa/releases/tag/v1.2.4)

**Release Date:** 2026-01-04

**Type:** Patch release - Recovery notifications and test infrastructure improvements.

## What's Changed

### üêõ Bug Fixes

- **Fixed recovery notification display** - Switched from HA repair issues to `persistent_notification` for
  recovery notifications. When clicking the notification, the full message with timestamps now displays correctly.
- **Fixed duplicate notifications** - Recovery notifications no longer appear twice after acknowledging.

### üß™ Testing Improvements

- **Improved test coverage** - Increased from 87% to 95%+ with comprehensive test suite
- **Fixed test infrastructure** - Enabled full Home Assistant integration tests by switching from editable install
  to direct install in CI workflow
- **Added pytest-homeassistant-custom-component** - Proper plugin registration for HA testing
- **Fixed test mocking** - Corrected patch locations and mock patterns for HA services

### üßπ CI/CD Improvements

- **Updated lint workflow** - Use `demjson3` jsonlint for JSON validation
- **Added workflow run logs workaround** - Documentation for getting test coverage from GitHub Actions
- **Improved Release Readiness Checklist** - Better format and verification steps

## Files Changed

- `custom_components/sinapsi_alfa/coordinator.py` - Recovery notification using persistent_notification
- `tests/conftest.py` - Added pytest_plugins registration
- `tests/test_config_flow.py` - Fixed test mocking patterns
- `.github/workflows/test.yml` - Changed to direct install method
- `requirements-dev.txt` - New file for dev dependencies
- `CLAUDE.md` - Documentation improvements

## Upgrade Notes

No breaking changes. This is a drop-in replacement for v1.2.3.

### For Beta Testers

If you were using v1.2.4-beta.1, the recovery notification improvements are now stable and ready for production use.

## Full Changelog

[v1.2.3...v1.2.4](https://github.com/alexdelprete/ha-sinapsi-alfa/compare/v1.2.3...v1.2.4)
