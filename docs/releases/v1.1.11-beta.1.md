# v1.1.11-beta.1

**Release Date:** 2025-12-27

**Type:** Beta Release

> **Testing Required:** This is a beta release with significant config flow changes. Please test and report any issues.

## What's Changed

### Config Entry Migration (v1 → v2)

- **Breaking Change**: Config entry version upgraded from 1 to 2
- **Migration**: `scan_interval` and `timeout` moved from `data` to `options`
- Existing installations will be automatically migrated on first load
- If migration fails, integration will need to be reconfigured

### OptionsFlowWithReload

- Replaced manual update listener with `OptionsFlowWithReload` pattern
- Options changes now automatically trigger integration reload
- Cleaner code without manual callback registration

### Config Flow Improvements

- Renamed internal method `get_unique_id()` → `_test_connection()` for clarity
- Added proper type hints throughout config flow
- Improved error handling in connection testing

### Code Quality

- Added missing imports for `CONF_SCAN_INTERVAL`, `CONF_TIMEOUT` in `__init__.py`
- Removed commented-out legacy migration code
- Added downgrade protection (prevents loading with future config versions)

## Testing Focus

Please test the following scenarios:

1. **Fresh Installation**

   - Install integration from scratch
   - Verify all sensors appear correctly

1. **Upgrade from v1.1.10**

   - Update to this beta
   - Verify migration completes without errors
   - Check that `scan_interval` and `timeout` are preserved in options

1. **Options Flow**

   - Change scan interval or timeout in options
   - Verify integration reloads automatically
   - Confirm new values are applied

1. **Reconfigure Flow**

   - Change host/port via reconfigure
   - Verify connection test works

## Known Issues

- None reported yet (beta testing in progress)

## Reporting Issues

If you encounter any problems:

1. Check Home Assistant logs for error messages
1. Report issues at: [GitHub Issues](https://github.com/alexdelprete/ha-sinapsi-alfa/issues)
1. Include log snippets and steps to reproduce

## Full Changelog

[Compare v1.1.10...v1.1.11-beta.1](https://github.com/alexdelprete/ha-sinapsi-alfa/compare/v1.1.10...v1.1.11-beta.1)
